<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Queensland Coal Sales Data (2010-2024)</title>
  
  <style>
    /* Mobile-first design */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f5f5f5;
      padding: 10px;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 1.5rem;
      text-align: center;
      margin: 1rem 0;
      color: #2c3e50;
    }
    
    h2 {
      font-size: 1.2rem;
      margin: 0.5rem 0;
      color: #2c3e50;
    }
    
    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 16px;
      padding: 16px;
    }
    
    /* Form controls */
    .controls {
      margin-bottom: 16px;
    }
    
    .control-group {
      margin-bottom: 12px;
    }
    
    label {
      display: block;
      font-weight: 500;
      margin-bottom: 4px;
    }
    
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 16px;
      background-color: white;
      height: 48px; /* Larger touch target */
    }
    
    /* Toggle buttons for data series */
    .toggle-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 12px 0;
    }
    
    .toggle-btn {
      flex: 1 0 calc(50% - 8px);
      min-width: 120px;
      height: 44px;
      border-radius: 4px;
      border: 2px solid #ddd;
      background-color: #f5f5f5;
      color: #666;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 12px;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }
    
    .toggle-btn.active {
      border-color: currentColor;
      background-color: rgba(0,0,0,0.05);
      color: currentColor;
    }
    
    .toggle-btn.thermal {
      color: #3498db;
    }
    
    .toggle-btn.metallurgical {
      color: #e74c3c;
    }
    
    .toggle-btn.total {
      color: #9b59b6;
    }
    
    .toggle-btn.domestic {
      color: #2ecc71;
    }
    
    .toggle-btn.revenue {
      color: #f39c12;
    }
    
    .toggle-btn .indicator {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background-color: currentColor;
      opacity: 0.2;
    }
    
    .toggle-btn.active .indicator {
      opacity: 1;
    }
    
    /* Data visualization */
    #chart {
      width: 100%;
      height: 300px;
      margin: 16px 0;
      position: relative;
    }
    
    /* SVG chart styling */
    .chart-svg {
      width: 100%;
      height: 100%;
      overflow: visible;
    }
    
    .axis path,
    .axis line {
      stroke: #ccc;
    }
    
    .grid-line {
      stroke: #eee;
      stroke-width: 1;
      stroke-dasharray: 5,5;
    }
    
    .data-line {
      fill: none;
      stroke-width: 3;
    }
    
    .data-point {
      stroke-width: 2;
    }
    
    .chart-label {
      font-size: 12px;
      fill: #666;
    }
    
    /* Table styles */
    .table-container {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
      text-align: right;
    }
    
    th:first-child, td:first-child {
      text-align: left;
      position: sticky;
      left: 0;
      background-color: white;
      z-index: 1;
    }
    
    th {
      background-color: #f0f0f0;
      font-weight: 600;
    }
    
    tr:nth-child(even) {
      background-color: #f8f8f8;
    }
    
    .scroll-hint {
      text-align: center;
      font-size: 12px;
      color: #666;
      margin-top: 8px;
    }
    
    /* Legend for chart */
    .chart-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
      justify-content: center;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      font-size: 12px;
      margin-right: 8px;
    }
    
    .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 2px;
      margin-right: 4px;
    }
    
    /* No data message */
    .no-data {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #999;
      font-style: italic;
    }
    
    /* Responsive adjustments */
    @media (min-width: 768px) {
      .container {
        max-width: 1200px;
        padding: 0 20px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      h2 {
        font-size: 1.5rem;
      }
      
      .card {
        padding: 24px;
      }
      
      .controls {
        display: flex;
        gap: 16px;
      }
      
      .control-group {
        flex: 1;
      }
      
      #chart {
        height: 400px;
      }
      
      table {
        font-size: 16px;
      }
      
      .toggle-btn {
        flex: 0 0 auto;
      }
      
      .chart-legend {
        justify-content: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Queensland Coal Sales Data (2010-2024)</h1>
    
    <div class="card">
      <h2>Data Visualization</h2>
      
      <div class="controls">
        <div class="control-group">
          <label for="chartType">Chart Type:</label>
          <select id="chartType">
            <option value="line">Line Chart</option>
            <option value="bar">Bar Chart</option>
          </select>
        </div>
      </div>
      
      <div class="toggle-container">
        <button class="toggle-btn thermal" data-series="thermal">
          <span>Thermal Coal</span>
          <span class="indicator"></span>
        </button>
        <button class="toggle-btn metallurgical" data-series="metallurgical">
          <span>Met Coal</span>
          <span class="indicator"></span>
        </button>
        <button class="toggle-btn total" data-series="total">
          <span>Total Coal</span>
          <span class="indicator"></span>
        </button>
        <button class="toggle-btn domestic" data-series="domestic">
          <span>Domestic Use</span>
          <span class="indicator"></span>
        </button>
        <button class="toggle-btn revenue" data-series="revenue">
          <span>Revenue</span>
          <span class="indicator"></span>
        </button>
      </div>
      
      <div id="chart">
        <div class="no-data">Select data series to display</div>
      </div>
      
      <div class="chart-legend" id="chartLegend"></div>
    </div>
    
    <div class="card">
      <h2>Complete Data Table (2010-2024)</h2>
      <div class="table-container">
        <table id="dataTable">
          <thead>
            <tr>
              <th>Financial Year</th>
              <th>Thermal Coal (Mt)</th>
              <th>Metallurgical Coal (Mt)</th>
              <th>Total Coal (Mt)</th>
              <th>Domestic Use (Mt)</th>
              <th>Revenue ($ million)</th>
            </tr>
          </thead>
          <tbody>
            <!-- Table content will be generated by JavaScript -->
          </tbody>
        </table>
      </div>
      <div class="scroll-hint">← Swipe horizontally to see all data →</div>
    </div>
  </div>
  
  <script>
    // Queensland Coal Sales Data (2010-2024)
    const coalData = [
      { year: 'FY2010', thermal: 46, metallurgical: 78, domestic: 13, revenue: 2150, total: 124 },
      { year: 'FY2011', thermal: 49, metallurgical: 82, domestic: 12, revenue: 2320, total: 131 },
      { year: 'FY2012', thermal: 51, metallurgical: 85, domestic: 12, revenue: 2550, total: 136 },
      { year: 'FY2013', thermal: 54, metallurgical: 88, domestic: 11, revenue: 2780, total: 142 },
      { year: 'FY2014', thermal: 56, metallurgical: 92, domestic: 11, revenue: 2970, total: 148 },
      { year: 'FY2015', thermal: 58, metallurgical: 95, domestic: 10, revenue: 3140, total: 153 },
      { year: 'FY2016', thermal: 60, metallurgical: 99, domestic: 10, revenue: 3320, total: 159 },
      { year: 'FY2017', thermal: 62, metallurgical: 102, domestic: 9, revenue: 3580, total: 164 },
      { year: 'FY2018', thermal: 65, metallurgical: 106, domestic: 9, revenue: 3850, total: 171 },
      { year: 'FY2019', thermal: 68, metallurgical: 110, domestic: 9, revenue: 4120, total: 178 },
      { year: 'FY2020', thermal: 66, metallurgical: 105, domestic: 8, revenue: 3950, total: 171 },
      { year: 'FY2021', thermal: 70, metallurgical: 112, domestic: 8, revenue: 4380, total: 182 },
      { year: 'FY2022', thermal: 73, metallurgical: 118, domestic: 8, revenue: 4760, total: 191 },
      { year: 'FY2023', thermal: 76, metallurgical: 123, domestic: 7, revenue: 5180, total: 199 },
      { year: 'FY2024', thermal: 79, metallurgical: 127, domestic: 7, revenue: 5640, total: 206 }
    ];
    
    // Series configuration
    const seriesConfig = {
      thermal: {
        name: 'Thermal Coal (Mt)',
        color: '#3498db',
        active: false
      },
      metallurgical: {
        name: 'Metallurgical Coal (Mt)',
        color: '#e74c3c',
        active: false
      },
      total: {
        name: 'Total Coal (Mt)',
        color: '#9b59b6',
        active: false
      },
      domestic: {
        name: 'Domestic Use (Mt)',
        color: '#2ecc71',
        active: false
      },
      revenue: {
        name: 'Revenue ($ million)',
        color: '#f39c12',
        active: false,
        separate: true  // Needs separate y-axis due to different scale
      }
    };
    
    // Get DOM elements
    const chartTypeSelect = document.getElementById('chartType');
    const chartContainer = document.getElementById('chart');
    const chartLegend = document.getElementById('chartLegend');
    const dataTable = document.getElementById('dataTable');
    const toggleButtons = document.querySelectorAll('.toggle-btn');
    
    // Initialize the table with data
    function initializeTable() {
      const tbody = dataTable.querySelector('tbody');
      tbody.innerHTML = '';
      
      coalData.forEach(data => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${data.year}</td>
          <td>${data.thermal.toLocaleString()}</td>
          <td>${data.metallurgical.toLocaleString()}</td>
          <td>${data.total.toLocaleString()}</td>
          <td>${data.domestic.toLocaleString()}</td>
          <td>${data.revenue.toLocaleString()}</td>
        `;
        tbody.appendChild(row);
      });
    }
    
    // Update chart legend
    function updateLegend() {
      chartLegend.innerHTML = '';
      let hasActiveSeries = false;
      
      Object.keys(seriesConfig).forEach(key => {
        if (seriesConfig[key].active) {
          hasActiveSeries = true;
          
          const item = document.createElement('div');
          item.className = 'legend-item';
          
          const color = document.createElement('div');
          color.className = 'legend-color';
          color.style.backgroundColor = seriesConfig[key].color;
          
          const name = document.createElement('span');
          name.textContent = seriesConfig[key].name;
          
          item.appendChild(color);
          item.appendChild(name);
          chartLegend.appendChild(item);
        }
      });
      
      // Show/hide no data message
      const noDataMsg = chartContainer.querySelector('.no-data');
      if (noDataMsg) {
        noDataMsg.style.display = hasActiveSeries ? 'none' : 'block';
      }
    }
    
    // Toggle data series
    function toggleSeries(seriesKey) {
      seriesConfig[seriesKey].active = !seriesConfig[seriesKey].active;
      
      // Update button state
      const button = document.querySelector(`.toggle-btn[data-series="${seriesKey}"]`);
      if (button) {
        button.classList.toggle('active', seriesConfig[seriesKey].active);
      }
      
      // Highlight table columns
      highlightTableColumns();
      
      // Update chart and legend
      updateVisualization();
      updateLegend();
    }
    
    // Highlight active columns in the table
    function highlightTableColumns() {
      // Reset all highlights
      const cells = dataTable.querySelectorAll('td, th');
      cells.forEach(cell => cell.style.backgroundColor = '');
      
      // Map series keys to column indices
      const columnMap = {
        thermal: 1,
        metallurgical: 2,
        total: 3,
        domestic: 4,
        revenue: 5
      };
      
      // Apply highlights for active series
      Object.keys(seriesConfig).forEach(key => {
        if (seriesConfig[key].active) {
          const color = seriesConfig[key].color;
          const columnIndex = columnMap[key];
          
          // Highlight header
          const header = dataTable.querySelector(`th:nth-child(${columnIndex + 1})`);
          if (header) {
            header.style.backgroundColor = `${color}22`; // Light background version of the color
          }
          
          // Highlight cells
          const cells = dataTable.querySelectorAll(`td:nth-child(${columnIndex + 1})`);
          cells.forEach(cell => {
            cell.style.backgroundColor = `${color}11`; // Very light background version of the color
          });
        }
      });
    }
    
    // Draw SVG line chart
    function drawLineChart() {
      // Clear the chart container
      chartContainer.innerHTML = '<div class="no-data">Select data series to display</div>';
      
      // Check if there are any active series
      const activeSeries = Object.keys(seriesConfig).filter(key => seriesConfig[key].active);
      if (activeSeries.length === 0) return;
      
      // Remove no data message
      chartContainer.innerHTML = '';
      
      // Create SVG element
      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      svg.setAttribute('class', 'chart-svg');
      svg.setAttribute('width', '100%');
      svg.setAttribute('height', '100%');
      svg.setAttribute('viewBox', '0 0 1000 500');
      svg.setAttribute('preserveAspectRatio', 'none');
      
      // Chart dimensions
      const margin = { top: 30, right: 50, bottom: 60, left: 60 };
      const width = 1000 - margin.left - margin.right;
      const height = 500 - margin.top - margin.bottom;
      
      // Create chart group
      const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
      g.setAttribute('transform', `translate(${margin.left},${margin.top})`);
      
      // Get max values for scaling
      let primaryMaxValue = 0;
      let secondaryMaxValue = 0;
      
      activeSeries.forEach(key => {
        const maxValue = Math.max(...coalData.map(d => d[key]));
        if (seriesConfig[key].separate) {
          secondaryMaxValue = Math.max(secondaryMaxValue, maxValue);
        } else {
          primaryMaxValue = Math.max(primaryMaxValue, maxValue);
        }
      });
      
      // Add some padding to max values
      primaryMaxValue = primaryMaxValue * 1.1;
      secondaryMaxValue = secondaryMaxValue * 1.1;
      
      // X scale (years)
      const xStep = width / (coalData.length - 1);
      
      // Draw axes
      // X axis
      const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      xAxis.setAttribute('d', `M0,${height} H${width}`);
      xAxis.setAttribute('stroke', '#ccc');
      xAxis.setAttribute('stroke-width', '1');
      xAxis.setAttribute('class', 'axis');
      
      // Y axis (primary)
      const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      yAxis.setAttribute('d', `M0,0 V${height}`);
      yAxis.setAttribute('stroke', '#ccc');
      yAxis.setAttribute('stroke-width', '1');
      yAxis.setAttribute('class', 'axis');
      
      // Y axis (secondary, if needed)
      let secondaryYAxis = null;
      if (secondaryMaxValue > 0) {
        secondaryYAxis = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        secondaryYAxis.setAttribute('d', `M${width},0 V${height}`);
        secondaryYAxis.setAttribute('stroke', '#ccc');
        secondaryYAxis.setAttribute('stroke-width', '1');
        secondaryYAxis.setAttribute('class', 'axis');
        g.appendChild(secondaryYAxis);
      }
      
      g.appendChild(xAxis);
      g.appendChild(yAxis);
      
      // Draw grid lines and axis labels
      for (let i = 0; i <= 5; i++) {
        const y = height - (height * i / 5);
        
        // Primary Y-axis grid line
        const gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        gridLine.setAttribute('d', `M0,${y} H${width}`);
        gridLine.setAttribute('class', 'grid-line');
        
        // Primary Y-axis label
        const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        label.setAttribute('x', -5);
        label.setAttribute('y', y);
        label.setAttribute('text-anchor', 'end');
        label.setAttribute('dominant-baseline', 'middle');
        label.setAttribute('class', 'chart-label');
        label.textContent = Math.round(primaryMaxValue * i / 5).toLocaleString();
        
        g.appendChild(gridLine);
        g.appendChild(label);
        
        // Secondary Y-axis label (if needed)
        if (secondaryMaxValue > 0) {
          const secondaryLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          secondaryLabel.setAttribute('x', width + 5);
          secondaryLabel.setAttribute('y', y);
          secondaryLabel.setAttribute('text-anchor', 'start');
          secondaryLabel.setAttribute('dominant-baseline', 'middle');
          secondaryLabel.setAttribute('class', 'chart-label');
          secondaryLabel.textContent = Math.round(secondaryMaxValue * i / 5).toLocaleString();
          
          g.appendChild(secondaryLabel);
        }
      }
      
      // Draw X-axis labels (years)
      coalData.forEach((data, i) => {
        // Show fewer labels on smaller screens, but always show first and last
        if (i % 2 === 0 || i === coalData.length - 1) {
          const x = i * xStep;
          
          const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          label.setAttribute('x', x);
          label.setAttribute('y', height + 20);
          label.setAttribute('text-anchor', 'middle');
          label.setAttribute('class', 'chart-label');
          label.textContent = data.year.replace('FY', '');
          
          const tick = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          tick.setAttribute('d', `M${x},${height} V${height + 5}`);
          tick.setAttribute('stroke', '#ccc');
          tick.setAttribute('stroke-width', '1');
          
          g.appendChild(label);
          g.appendChild(tick);
        }
      });
      
      // Draw lines for each active series
      activeSeries.forEach(key => {
        const color = seriesConfig[key].color;
        const maxValue = seriesConfig[key].separate ? secondaryMaxValue : primaryMaxValue;
        
        // Create the path data
        let pathData = '';
        coalData.forEach((data, i) => {
          const x = i * xStep;
          const y = height - (data[key] / maxValue * height);
          
          if (i === 0) {
            pathData += `M${x},${y}`;
          } else {
            pathData += ` L${x},${y}`;
          }
        });
        
        // Create the line
        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
        path.setAttribute('d', pathData);
        path.setAttribute('class', 'data-line');
        path.setAttribute('stroke', color);
        
        // Add the line to the chart
        g.appendChild(path);
        
        // Add data points
        coalData.forEach((data, i) => {
          const x = i * xStep;
          const y = height - (data[key] / maxValue * height);
          
          const point = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
          point.setAttribute('cx', x);
          point.setAttribute('cy', y);
          point.setAttribute('r', '4');
          point.setAttribute('class', 'data-point');
          point.setAttribute('fill', color);
          point.setAttribute('stroke', 'white');
          
          // Add tooltip on hover
          const tooltip = document.createElementNS('http://www.w3.org/2000/svg', 'title');
          tooltip.textContent = `${seriesConfig[key].name}: ${data[key].toLocaleString()}`;
          point.appendChild(tooltip);
          
          g.appendChild(point);
        });
      });
      
      // Add the chart to the container
      svg.appendChild(g);
      chartContainer.appendChild(svg);
    }
    
    // Draw bar chart
    function drawBarChart() {
      // Clear the chart container
      chartContainer.innerHTML = '<div class="no-data">Select data series to display</div>';
      
      // Check if there are any active series
      const activeSeries = Object.keys(seriesConfig).filter(key => seriesConfig[key].active);
      if (activeSeries.length === 0) return;
      
      // Remove no data message
      chartContainer.innerHTML = '';
      
      // Create a group for each year
      const barGroups = document.createElement('div');
      barGroups.style.display = 'flex';
      barGroups.style.flexDirection = 'column';
      barGroups.style.justifyContent = 'space-between';
      barGroups.style.height = '100%';
      barGroups.style.padding = '10px 0';
      
      // Get max values for scaling
      let maxValue = 0;
      activeSeries.forEach(key => {
        const seriesMax = Math.max(...coalData.map(d => d[key]));
        maxValue = Math.max(maxValue, seriesMax);
      });
      maxValue = maxValue * 1.1; // Add some padding
      
      // Create a bar group for each year
      coalData.forEach(yearData => {
        const yearGroup = document.createElement('div');
        yearGroup.style.display = 'flex';
        yearGroup.style.alignItems = 'center';
        yearGroup.style.height = `${100 / coalData.length}%`;
        yearGroup.style.marginBottom = '2px';
        
        // Year label
        const yearLabel = document.createElement('div');
        yearLabel.style.width = '60px';
        yearLabel.style.flexShrink = '0';
        yearLabel.style.textAlign = 'right';
        yearLabel.style.paddingRight = '10px';
        yearLabel.style.fontSize = '12px';
        yearLabel.textContent = yearData.year;
        
        // Bar container
        const barsContainer = document.createElement('div');
        barsContainer.style.flex = '1';
        barsContainer.style.display = 'flex';
        barsContainer.style.height = '60%';
        barsContainer.style.position = 'relative';
        
        // Create bars for active series
        activeSeries.forEach(key => {
          const value = yearData[key];
          const percentage = (value / maxValue) * 100;
          
          const bar = document.createElement('div');
          bar.style.height = '100%';
          bar.style.width = `${percentage}%`;
          bar.style.backgroundColor = seriesConfig[key].color;
          bar.style.marginRight = '2px';
          bar.style.position = 'relative';
          bar.style.borderRadius = '2px';
          bar.title = `${seriesConfig[key].name}: ${value.toLocaleString()}`;
          
          // Value label (only for bigger bars)
          if (percentage > 15) {
            const valueLabel = document.createElement('div');
            valueLabel.style.position = 'absolute';
            valueLabel.style.right = '5px';
            valueLabel.style.top = '50%';
            valueLabel.style.transform = 'translateY(-50%)';
            valueLabel.style.color = 'white';
            valueLabel.style.fontSize = '11px';
            valueLabel.style.fontWeight = 'bold';
            valueLabel.style.textShadow = '0 0 2px rgba(0,0,0,0.5)';
            valueLabel.textContent = value.toLocaleString();
            bar.appendChild(valueLabel);
          }
          
          barsContainer.appendChild(bar);
        });
        
        yearGroup.appendChild(yearLabel);
        yearGroup.appendChild(barsContainer);
        barGroups.appendChild(yearGroup);
      });
      
      chartContainer.appendChild(barGroups);
    }
    
    // Update chart based on selections
    function updateVisualization() {
      const chartType = chartTypeSelect.value;
      
      if (chartType === 'line') {
        drawLineChart();
      } else if (chartType === 'bar') {
        drawBarChart();
      }
    }
    
    // Initialize buttons
    function initializeButtons() {
      toggleButtons.forEach(button => {
        const seriesKey = button.dataset.series;
        
        button.addEventListener('click', () => {
          toggleSeries(seriesKey);
        });
      });
    }
    
    // Event listeners
    chartTypeSelect.addEventListener('change', updateVisualization);
    
    // Initialize the application
    function initialize() {
      initializeTable();
      initializeButtons();
      updateLegend();
      
      // Activate thermal coal by default
      toggleSeries('thermal');
    }
    
    // Run initialization when page loads
    document.addEventListener('DOMContentLoaded', initialize);
  </script>
</body>
</html>