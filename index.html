<!DOCTYPE html>
<html>
<head>
  <title>Simple Excel Viewer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f5f5f5;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 0;
    }
    button:hover {
      background-color: #45a049;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Simple Excel Viewer</h1>
    
    <div>
      <p>Upload an Excel file (.xlsx or .xls) to view its contents:</p>
      <input type="file" id="fileUpload" accept=".xlsx, .xls" />
      <button id="loadSample">Load Sample Data</button>
    </div>
    
    <div id="output">
      <h2>Data Preview:</h2>
      <div id="tableContainer"></div>
    </div>
  </div>
  
  <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
  <script>
    // Wait for the DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('fileUpload');
      const loadSampleBtn = document.getElementById('loadSample');
      const tableContainer = document.getElementById('tableContainer');
      
      // Handle file upload
      fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        
        reader.onload = function(e) {
          const data = new Uint8Array(e.target.result);
          processExcel(data);
        };
        
        reader.readAsArrayBuffer(file);
      });
      
      // Handle sample data
      loadSampleBtn.addEventListener('click', function() {
        // Generate sample data
        const sampleData = generateSampleData();
        displayData(sampleData);
      });
      
      // Process Excel data
      function processExcel(data) {
        try {
          // Parse the Excel file
          const workbook = XLSX.read(data, { type: 'array' });
          
          // Get the first sheet
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];
          
          // Convert to JSON
          const jsonData = XLSX.utils.sheet_to_json(worksheet);
          
          // Display the data
          displayData(jsonData);
        } catch (error) {
          console.error('Error processing Excel file:', error);
          tableContainer.innerHTML = '<p style="color: red;">Error processing the file. Please make sure it\'s a valid Excel file.</p>';
        }
      }
      
      // Display data in a table
      function displayData(data) {
        if (!data || data.length === 0) {
          tableContainer.innerHTML = '<p>No data to display</p>';
          return;
        }
        
        // Get column headers from the first row
        const columns = Object.keys(data[0]);
        
        // Create the table
        let tableHtml = '<table><thead><tr>';
        
        // Add headers
        columns.forEach(column => {
          tableHtml += `<th>${column}</th>`;
        });
        
        tableHtml += '</tr></thead><tbody>';
        
        // Add rows (limit to first 10 rows)
        const rowLimit = Math.min(data.length, 10);
        for (let i = 0; i < rowLimit; i++) {
          tableHtml += '<tr>';
          columns.forEach(column => {
            tableHtml += `<td>${data[i][column] !== undefined ? data[i][column] : ''}</td>`;
          });
          tableHtml += '</tr>';
        }
        
        tableHtml += '</tbody></table>';
        
        // Add a message if data was truncated
        if (data.length > 10) {
          tableHtml += `<p><em>Showing 10 rows of ${data.length} total rows</em></p>`;
        }
        
        // Set the HTML
        tableContainer.innerHTML = tableHtml;
      }
      
      // Generate sample data
      function generateSampleData() {
        const years = ['FY2010', 'FY2011', 'FY2012', 'FY2013', 'FY2014', 
                       'FY2015', 'FY2016', 'FY2017', 'FY2018', 'FY2019',
                       'FY2020', 'FY2021', 'FY2022', 'FY2023', 'FY2024'];
        
        return years.map(year => ({
          'Financial Year': year,
          'Thermal Coal (Mt)': Math.round(40 + Math.random() * 20),
          'Metallurgical Coal (Mt)': Math.round(70 + Math.random() * 40),
          'Total Export (Mt)': Math.round(120 + Math.random() * 50),
          'Domestic Use (Mt)': Math.round(10 + Math.random() * 7),
        }));
      }
    });
  </script>
</body>
</html>